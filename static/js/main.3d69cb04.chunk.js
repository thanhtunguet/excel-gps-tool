(this["webpackJsonpgmaps-coordinate-filler"]=this["webpackJsonpgmaps-coordinate-filler"]||[]).push([[0],{397:function(e,t){},565:function(e,t){},566:function(e,t){},900:function(e,t,a){},904:function(e,t,a){"use strict";a.r(t);var n=a(51),r=a(0),c=a.n(r),s=a(36),i=a.n(s),l=a(207),o=a(71),u=(a(151),a(925)),d=a(926),p=a(147),b=a.n(p),f=a(496),j=a.n(f),v=a(378),h=a.n(v),x=a(206),O=a.n(x),m=a(498),g=a.n(m),y=a(499),w=a.n(y),C={labelCol:{span:8},wrapperCol:{span:8}},k={wrapperCol:{offset:8,span:16}},I=[{title:"Column",dataIndex:"no"},{title:"Address",dataIndex:"address",render:function(e){return null===e||void 0===e?void 0:e.v}},{title:"Latitude",dataIndex:"latitude",render:function(e){return null===e||void 0===e?void 0:e.v}},{title:"Longitude",dataIndex:"longitude",render:function(e){return null===e||void 0===e?void 0:e.v}}],P=a(11),S=a(15),N=a(16),A=a(488),F=a(137),_=a.n(F);function D(){return[c.a.useCallback((function(){var e=_.a.utils.book_new(),t=_.a.utils.json_to_sheet([{no:"",address:"",latitude:"",longitude:""}]);_.a.utils.book_append_sheet(e,t,"addresses"),_.a.writeFile(e,"template.xlsx")}),[])]}var E,M=a(5),T=a.n(M),B=a(14),L=a(313),$=a.n(L),G=a(500);function J(e,t){switch(t.type){case E.replace:return t.list;case E.patchIndex:return e[t.index]=t.record,Object(G.a)(e);default:return e}}function K(e){return new Promise((function(t,a){var n=new FileReader;n.onload=function(){t(this.result)},n.onerror=function(e){a(e)},n.readAsBinaryString(e)}))}function R(e){var t=e.replace(/^([A-Z]+)([0-9]+)$/,"$1-$2").split("-",2),a=Object(o.a)(t,2);return{col:a[0],row:a[1]}}!function(e){e[e.replace=0]="replace",e[e.patchIndex=1]="patchIndex"}(E||(E={}));var Y=a(394),z=a(25),W=a(923),Z=a(924),q=a(256),H=a(376),Q=a.n(H),U=a(489),V=a.n(U),X=Q.a.create();function ee(){var e=c.a.useState(null),t=Object(o.a)(e,2),a=t[0],n=t[1],r=c.a.useState(0),s=Object(o.a)(r,2),i=s[0],l=s[1],u=c.a.useState(""),d=Object(o.a)(u,2),p=d[0],b=d[1],f=c.a.useState(""),j=Object(o.a)(f,2),v=j[0],h=j[1],x=c.a.useState(!1),O=Object(o.a)(x,2),m=O[0],g=O[1];c.a.useEffect((function(){var e=V.a.parse(location.search);Object.prototype.hasOwnProperty.call(e,"appId")&&b(e.appId),Object.prototype.hasOwnProperty.call(e,"appCode")&&h(e.appCode)}),[]);var y=c.a.useCallback((function(e){b(e.target.value)}),[]),w=c.a.useCallback((function(e){h(e.target.value)}),[]),C=c.a.useCallback((function(){return!(!p||!v)||($.a.error("Missing API Key. You must have Google Maps API key to perform this action."),!1)}),[p,v]),k=c.a.useReducer(J,[]),I=Object(o.a)(k,2),P=I[0],S=I[1],N=c.a.useCallback(function(){var e=Object(B.a)(T.a.mark((function e(t){var a,r,c,s;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(C()){e.next=2;break}return e.abrupt("return");case 2:if(!((null===(a=t.target.files)||void 0===a?void 0:a.length)>0)){e.next=10;break}return e.next=5,K(t.target.files[0]);case 5:r=e.sent,c=_.a.read(r,{type:"binary"}),n(c),s=c.Sheets.addresses,S({type:E.replace,list:Object.entries(s).filter((function(e){var t=Object(o.a)(e,1)[0];return t.startsWith("A")&&"A1"!==t})).map((function(e){var t=Object(o.a)(e,1)[0],a=R(t).row;return{no:t,address:s["B".concat(a)],latitude:s["C".concat(a)],longitude:s["D".concat(a)]}}))});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[C]),A=c.a.useCallback(function(){var e=Object(B.a)(T.a.mark((function e(t,a,n,r){var c;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===(c=t.address)||void 0===c?void 0:c.v)){e.next=4;break}return e.next=3,Object(Y.a)(new z.a((function(e){var r=new W.a(X,a,n);new Z.a(r).geocode({address:t.address.h}).then((function(a){if((null===a||void 0===a?void 0:a.length)>0){var n=Object(o.a)(a,1)[0],r=n.latitude,c=n.longitude;t.latitude={v:r,t:"n"},t.longitude={v:c,t:"n"},e.next(t)}})).catch((function(t){e.error(t)})).finally((function(){e.complete()}))})).pipe(Object(q.a)(3)));case 3:S({type:E.patchIndex,index:r,record:t});case 4:return e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)})));return function(t,a,n,r){return e.apply(this,arguments)}}(),[]),F=c.a.useCallback(Object(B.a)(T.a.mark((function e(){var t,a;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(C()){e.next=2;break}return e.abrupt("return");case 2:g(!0),t=T.a.mark((function e(t){var a;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=P.slice(t,t+5),e.prev=1,e.next=4,Promise.all(a.map((function(e,a){return A(e,p,v,t+a)})));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.error(e.t0);case 9:l(t+Math.min(a.length,5)+t);case 10:case"end":return e.stop()}}),e,null,[[1,6]])})),a=0;case 5:if(!(a<P.length)){e.next=10;break}return e.delegateYield(t(a),"t0",7);case 7:a+=5,e.next=5;break;case 10:g(!1);case 11:case"end":return e.stop()}}),e)}))),[p,v,P,A,C]),D=c.a.useCallback((function(){m||a&&(P.forEach((function(e){var t=R(e.no).row;a.Sheets.addresses["C".concat(t)]=e.latitude,a.Sheets.addresses["D".concat(t)]=e.longitude})),_.a.writeFile(a,"result.xlsx"))}),[a,m,P]);return[p,y,v,w,N,i,F,D,P,m]}var te=new(function(e){Object(S.a)(a,e);var t=Object(N.a)(a);function a(){var e;return Object(P.a)(this,a),(e=t.call(this)).useTemplate=D,e.useFile=ee,e}return a}(A.Service)),ae=h.a.Item;var ne=function(){var e=te.useFile(),t=Object(o.a)(e,10),a=t[0],r=t[1],c=t[2],s=t[3],i=t[4],p=t[5],f=t[6],v=t[7],x=t[8],m=t[9],y=te.useTemplate(),P=Object(o.a)(y,1)[0];return Object(n.jsxs)(j.a,{title:"GMaps Coordinate Filler",className:"p-1",children:[Object(n.jsxs)(h.a,Object(l.a)(Object(l.a)({},C),{},{children:[Object(n.jsx)(ae,{label:"APP_ID",children:Object(n.jsx)(O.a,{className:"my-1",type:"text",value:a,onChange:r,placeholder:"APP_ID"})}),Object(n.jsx)(ae,{label:"APP_CODE",children:Object(n.jsx)(O.a,{className:"my-1",type:"text",value:c,onChange:s,placeholder:"APP_CODE"})}),Object(n.jsx)(ae,{label:"Data file",children:Object(n.jsx)(O.a,{className:"my-1",type:"file",onChange:i})}),Object(n.jsxs)(ae,Object(l.a)(Object(l.a)({},k),{},{children:[Object(n.jsx)(b.a,{className:"my-1 mr-2",type:"primary",onClick:f,loading:m,children:"Proceed"}),Object(n.jsx)(b.a,{className:"my-1 mr-2",type:"default",onClick:P,disabled:m,children:Object(n.jsxs)("div",{className:"d-flex align-items-center",children:["Template",Object(n.jsx)(u.a,{className:"ml-2"})]})}),Object(n.jsx)(b.a,{type:"primary",onClick:v,disabled:m,children:Object(n.jsxs)("div",{className:"d-flex align-items-center",children:["Export",Object(n.jsx)(d.a,{className:"ml-2"})]})})]}))]})),m&&(null===x||void 0===x?void 0:x.length)>0&&Object(n.jsx)(g.a,{className:"my-1",percent:Math.round(100*p/x.length),status:"active"}),Object(n.jsx)(w.a,{loading:m,className:"my-2",dataSource:x,rowKey:"no",columns:I,pagination:{pageSize:10}})]})},re=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,928)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,c=t.getLCP,s=t.getTTFB;a(e),n(e),r(e),c(e),s(e)}))};a(900);i.a.render(Object(n.jsx)(c.a.StrictMode,{children:Object(n.jsx)(ne,{})}),document.getElementById("root")),re()}},[[904,1,2]]]);
//# sourceMappingURL=main.3d69cb04.chunk.js.map