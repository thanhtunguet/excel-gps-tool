(this["webpackJsonpgmaps-coordinate-filler"]=this["webpackJsonpgmaps-coordinate-filler"]||[]).push([[0],{156:function(e,t){},276:function(e,t){},277:function(e,t){},532:function(e,t,a){},535:function(e,t,a){"use strict";a.r(t);var n=a(24),r=a(0),c=a.n(r),s=a(22),i=a.n(s),l=a(88),o=a(54),u=a.n(o),d=a(109),p=a(50),f=a(547),b=a(548),v=a(137),j=a(64),h=a.n(j),x=a(215),m=a.n(x),g=a(140),O=a.n(g),y=a(142),k=a.n(y),w=a(216),C=a.n(w),I=a(217),S=a.n(I);function N(e){var t=e.replace(/^([A-Z]+)([0-9]+)$/,"$1-$2").split("-",2),a=Object(p.a)(t,2);return{col:a[0],row:a[1]}}function P(e){return new Promise((function(t,a){var n=new FileReader;n.onload=function(){t(this.result)},n.onerror=function(e){a(e)},n.readAsBinaryString(e)}))}var A,F=a(218);function M(e,t){switch(t.type){case A.replace:return t.list;case A.patchIndex:return e[t.index]=t.record,Object(F.a)(e);default:return e}}!function(e){e[e.replace=0]="replace",e[e.patchIndex=1]="patchIndex"}(A||(A={}));var _=a(546),B=a(545),D=a(66),K=a.n(D),L=a(100),E=a.n(L),T=O.a.Item,$={labelCol:{span:8},wrapperCol:{span:8}},G={wrapperCol:{offset:8,span:16}},J=new v.Client;var R=function(){var e,t=c.a.useState(null),a=Object(p.a)(t,2),r=a[0],s=a[1],i=c.a.useState(0),o=Object(p.a)(i,2),v=o[0],j=o[1],x=c.a.useState(""),g=Object(p.a)(x,2),y=g[0],w=g[1],I=c.a.useState(!1),F=Object(p.a)(I,2),D=F[0],L=F[1],R=c.a.useCallback((function(e){w(e.target.value)}),[]),Y=c.a.useCallback((function(){return y||E.a.error("Missing API Key. You must have Google Maps API key to perform this action."),!!y}),[y]),z=c.a.useReducer(M,[]),W=Object(p.a)(z,2),Z=W[0],q=W[1],H=c.a.useCallback(function(){var e=Object(d.a)(u.a.mark((function e(t){var a,n,r,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Y()){e.next=2;break}return e.abrupt("return");case 2:if(!((null===(a=t.target.files)||void 0===a?void 0:a.length)>0)){e.next=10;break}return e.next=5,P(t.target.files[0]);case 5:n=e.sent,r=K.a.read(n,{type:"binary"}),s(r),c=r.Sheets.addresses,q({type:A.replace,list:Object.entries(c).filter((function(e){var t=Object(p.a)(e,1)[0];return t.startsWith("A")&&"A1"!==t})).map((function(e){var t=Object(p.a)(e,1)[0],a=N(t).row;return{no:t,address:c["B".concat(a)],latitude:c["C".concat(a)],longitude:c["D".concat(a)]}}))});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[Y]),Q=c.a.useCallback(function(){var e=Object(d.a)(u.a.mark((function e(t,a,n){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===(r=t.address)||void 0===r?void 0:r.v)){e.next=4;break}return e.next=3,new _.a((function(e){var n;J.geocode({params:{address:null===(n=t.address)||void 0===n?void 0:n.h,key:a}}).then((function(a){var n;if((null===(n=a.data.results)||void 0===n?void 0:n.length)>0){var r=a.data.results[0].geometry.location,c=r.lat,s=r.lng;t.latitude={v:c,t:"n"},t.longitude={v:s,t:"n"},e.next(t)}})).catch((function(t){e.error(t)})).finally((function(){e.complete()}))})).pipe(Object(B.a)(3)).toPromise();case 3:q({type:A.patchIndex,index:n,record:t});case 4:return e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),[]),U=c.a.useCallback(Object(d.a)(u.a.mark((function e(){var t,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Y()){e.next=2;break}return e.abrupt("return");case 2:L(!0),t=u.a.mark((function e(t){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Z.slice(t,t+5),e.prev=1,e.next=4,Promise.all(a.map((function(e,a){return Q(e,y,t+a)})));case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:j(t+Math.min(a.length,5)+t);case 9:case"end":return e.stop()}}),e,null,[[1,6]])})),a=0;case 5:if(!(a<Z.length)){e.next=10;break}return e.delegateYield(t(a),"t0",7);case 7:a+=5,e.next=5;break;case 10:L(!1);case 11:case"end":return e.stop()}}),e)}))),[y,Z,Q,Y]),V=c.a.useCallback((function(){D||r&&(Z.forEach((function(e){var t=N(e.no).row;r.Sheets.addresses["C".concat(t)]=e.latitude,r.Sheets.addresses["D".concat(t)]=e.longitude})),K.a.writeFile(r,"result.xlsx"))}),[r,D,Z]),X=c.a.useCallback((function(){var e=K.a.utils.book_new(),t=K.a.utils.json_to_sheet([{no:"",address:"",latitude:"",longitude:""}]);K.a.utils.book_append_sheet(e,t,"addresses"),K.a.writeFile(e,"template.xlsx")}),[]),ee=c.a.useMemo((function(){return[{title:"Column",dataIndex:"no"},{title:"Address",dataIndex:"address",render:function(e){return null===e||void 0===e?void 0:e.v}},{title:"Latitude",dataIndex:"latitude",render:function(e){return null===e||void 0===e?void 0:e.v}},{title:"Longitude",dataIndex:"longitude",render:function(e){return null===e||void 0===e?void 0:e.v}}]}),[]);return Object(n.jsxs)(m.a,{title:"GMaps Coordinate Filler",className:"p-1",children:[Object(n.jsxs)(O.a,Object(l.a)(Object(l.a)({},$),{},{children:[Object(n.jsx)(T,{label:"API Key",children:Object(n.jsx)(k.a,{className:"my-1",type:"text",value:y,onChange:R,placeholder:"API Key"})}),Object(n.jsx)(T,{label:"Data file",children:Object(n.jsx)(k.a,{className:"my-1",type:"file",onChange:H})}),Object(n.jsxs)(T,Object(l.a)(Object(l.a)({},G),{},{children:[Object(n.jsx)(h.a,{className:"my-1 mr-2",type:"primary",onClick:U,loading:D,children:"Proceed"}),Object(n.jsx)(h.a,{className:"my-1 mr-2",type:"default",onClick:X,disabled:D,children:Object(n.jsxs)("div",{className:"d-flex align-items-center",children:["Template",Object(n.jsx)(f.a,{className:"ml-2"})]})}),Object(n.jsx)(h.a,{type:"primary",onClick:V,disabled:D,children:Object(n.jsxs)("div",{className:"d-flex align-items-center",children:["Export",Object(n.jsx)(b.a,{className:"ml-2"})]})})]}))]})),D&&(null===Z||void 0===Z?void 0:Z.length)>0&&Object(n.jsx)(C.a,{className:"my-1",percent:Math.round(100*v/Z.length),status:"active"}),Object(n.jsx)(S.a,{className:"my-1",dataSource:Z,rowKey:"no",columns:ee,pagination:{pageSize:null!==(e=null===Z||void 0===Z?void 0:Z.length)&&void 0!==e?e:10}})]})},Y=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,549)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,c=t.getLCP,s=t.getTTFB;a(e),n(e),r(e),c(e),s(e)}))};a(532);i.a.render(Object(n.jsx)(c.a.StrictMode,{children:Object(n.jsx)(R,{})}),document.getElementById("root")),Y()}},[[535,1,2]]]);
//# sourceMappingURL=main.fe7d8bda.chunk.js.map