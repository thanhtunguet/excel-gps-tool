(this["webpackJsonpgmaps-coordinate-filler"]=this["webpackJsonpgmaps-coordinate-filler"]||[]).push([[0],{145:function(e,t){},213:function(e,t,n){},266:function(e,t){},267:function(e,t){},268:function(e,t,n){},515:function(e,t,n){"use strict";n.r(t);var a=n(33),r=n(0),c=n.n(r),i=n(22),s=n.n(i),o=(n(211),n(212),n(213),n(53)),l=n.n(o),u=n(100),d=n(47),f=n(128),p=n(63),v=n.n(p),b=n(202),h=n.n(b),x=n(131),j=n.n(x),m=n(203),g=n.n(m),y=n(204),O=n.n(y);function w(e){var t=e.replace(/^([A-Z]+)([0-9]+)$/,"$1-$2").split("-",2),n=Object(d.a)(t,2);return{col:n[0],row:n[1]}}function k(e){return new Promise((function(t,n){var a=new FileReader;a.onload=function(){t(this.result)},a.onerror=function(e){n(e)},a.readAsBinaryString(e)}))}var C,S=n(205);function I(e,t){switch(t.type){case C.replace:return t.list;case C.patchIndex:return e[t.index]=t.record,Object(S.a)(e);default:return e}}!function(e){e[e.replace=0]="replace",e[e.patchIndex=1]="patchIndex"}(C||(C={}));var N=n(524),F=n(523),P=n(65),A=n.n(P),M=(n(268),new f.Client);var _=function(){var e,t=c.a.useState(null),n=Object(d.a)(t,2),r=n[0],i=n[1],s=c.a.useState(0),o=Object(d.a)(s,2),f=o[0],p=o[1],b=c.a.useState(""),x=Object(d.a)(b,2),m=x[0],y=x[1],S=c.a.useState(!1),P=Object(d.a)(S,2),_=P[0],B=P[1],D=c.a.useCallback((function(e){y(e.target.value)}),[]),L=c.a.useReducer(I,[]),E=Object(d.a)(L,2),$=E[0],J=E[1],K=c.a.useCallback(function(){var e=Object(u.a)(l.a.mark((function e(t){var n,a,r,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((null===(n=t.target.files)||void 0===n?void 0:n.length)>0)){e.next=8;break}return e.next=3,k(t.target.files[0]);case 3:a=e.sent,r=A.a.read(a,{type:"binary"}),i(r),c=r.Sheets.addresses,J({type:C.replace,list:Object.entries(c).filter((function(e){var t=Object(d.a)(e,1)[0];return t.startsWith("A")&&"A1"!==t})).map((function(e){var t=Object(d.a)(e,1)[0],n=w(t).row;return{no:t,address:c["B".concat(n)],latitude:c["C".concat(n)],longitude:c["D".concat(n)]}}))});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]),R=c.a.useCallback(function(){var e=Object(u.a)(l.a.mark((function e(t,n,a){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===(r=t.address)||void 0===r?void 0:r.v)){e.next=4;break}return e.next=3,new N.a((function(e){var a;M.geocode({params:{address:null===(a=t.address)||void 0===a?void 0:a.h,key:n}}).then((function(n){var a;if((null===(a=n.data.results)||void 0===a?void 0:a.length)>0){var r=n.data.results[0].geometry.location,c=r.lat,i=r.lng;t.latitude={v:c,t:"n"},t.longitude={v:i,t:"n"},e.next(t)}})).catch((function(t){e.error(t)})).finally((function(){e.complete()}))})).pipe(Object(F.a)(3)).toPromise();case 3:J({type:C.patchIndex,index:a,record:t});case 4:return e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),[]),T=c.a.useCallback(Object(u.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:B(!0),t=l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=$.slice(t,t+5),e.prev=1,e.next=4,Promise.all(n.map((function(e,n){return R(e,m,t+n)})));case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:p(t+Math.min(n.length,5)+t);case 9:case"end":return e.stop()}}),e,null,[[1,6]])})),n=0;case 3:if(!(n<$.length)){e.next=8;break}return e.delegateYield(t(n),"t0",5);case 5:n+=5,e.next=3;break;case 8:B(!1);case 9:case"end":return e.stop()}}),e)}))),[m,$,R]),z=c.a.useCallback((function(){_||($.forEach((function(e){var t=w(e.no).row;r.Sheets.addresses["C".concat(t)]=e.latitude,r.Sheets.addresses["D".concat(t)]=e.longitude})),A.a.writeFile(r,"result.xlsx"))}),[r,_,$]),G=c.a.useMemo((function(){return[{title:"Column",dataIndex:"no"},{title:"Address",dataIndex:"address",render:function(e){return null===e||void 0===e?void 0:e.v}},{title:"Latitude",dataIndex:"latitude",render:function(e){return null===e||void 0===e?void 0:e.v}},{title:"Longitude",dataIndex:"longitude",render:function(e){return null===e||void 0===e?void 0:e.v}}]}),[]),W=c.a.useCallback((function(){return Object(a.jsx)("div",{className:"w-100 d-flex justify-content-end",children:Object(a.jsx)(v.a,{type:"primary",onClick:z,disabled:_,children:"Export"})})}),[z,_]),Y=c.a.useCallback((function(){var e=A.a.utils.book_new(),t=A.a.utils.json_to_sheet([{no:"",address:"",latitude:"",longitude:""}]);A.a.utils.book_append_sheet(e,t,"addresses"),A.a.writeFile(e,"template.xlsx")}),[]);return Object(a.jsxs)(h.a,{title:"GMaps Coordinate Filler",className:"p-1",children:[Object(a.jsx)(j.a,{className:"my-1",type:"text",value:m,onChange:D,placeholder:"API Key"}),Object(a.jsx)(j.a,{className:"my-1",type:"file",onChange:K}),Object(a.jsxs)("div",{className:"d-flex justify-content-between",children:[Object(a.jsx)(v.a,{className:"my-1",type:"default",onClick:Y,disabled:_,children:"Download template"}),Object(a.jsx)(v.a,{className:"my-1",type:"primary",onClick:T,loading:_,children:"Proceed"})]}),_&&(null===$||void 0===$?void 0:$.length)>0&&Object(a.jsx)(g.a,{className:"my-1",percent:Math.round(100*f/$.length),status:"active"}),Object(a.jsx)(O.a,{title:W,className:"my-1",dataSource:$,rowKey:"no",columns:G,pagination:{pageSize:null!==(e=null===$||void 0===$?void 0:$.length)&&void 0!==e?e:10}})]})},B=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,525)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),c(e),i(e)}))};s.a.render(Object(a.jsx)(c.a.StrictMode,{children:Object(a.jsx)(_,{})}),document.getElementById("root")),B()}},[[515,1,2]]]);
//# sourceMappingURL=main.e5d9c330.chunk.js.map